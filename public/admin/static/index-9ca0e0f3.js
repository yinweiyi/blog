import{a7 as e,b as a,r as l,e as t,a as i,h as o,i as s,w as n,f as r,o as d,l as u,A as p,m as c,n as m,W as g,j as h,a8 as f,z as v,a9 as b,aa as w,B as _,E as V,_ as y}from"./index-2fc42248.js";import{u as C}from"./usePagination-8650a726.js";const k={class:"app-container"},z=a({name:"Friendship"}),S=a({...z,props:{friendship:{type:Object,required:!0},showDialog:{type:Boolean,required:!0,default:!1}},emits:["update:showDialog","update:friendship","handleSubmit"],setup(e,{emit:a}){const c=e,m=l({isShowDialog:c.showDialog,loading:!1}),g=t((()=>c.friendship)),h=e=>{a("update:showDialog",!1),e()},f=i(null),v=l({title:[{required:!0,message:"标题不能为空",trigger:"blur"}],link:[{required:!0,message:"链接不能为空",trigger:"blur"}]}),b=()=>{var e;null==(e=f.value)||e.validate((e=>{if(!e)return!1;a("update:friendship",g.value),a("handleSubmit")}))},w=()=>{a("update:showDialog",!1)};return(e,a)=>{const l=r("el-input"),t=r("el-form-item"),i=r("el-input-number"),c=r("el-switch"),_=r("el-form"),V=r("el-button"),y=r("el-card"),C=r("el-dialog");return d(),o("div",k,[s(C,{modelValue:m.isShowDialog,"onUpdate:modelValue":a[5]||(a[5]=e=>m.isShowDialog=e),title:"分类","before-close":h},{default:n((()=>[s(y,{shadow:"never"},{default:n((()=>[s(_,{model:u(g),ref_key:"formRef",ref:f,"label-position":"right","label-width":"100px",rules:v},{default:n((()=>[s(t,{label:"标题：",prop:"title"},{default:n((()=>[s(l,{class:"form-input",modelValue:u(g).title,"onUpdate:modelValue":a[0]||(a[0]=e=>u(g).title=e),placeholder:"请输入题"},null,8,["modelValue"])])),_:1}),s(t,{label:"链接：",prop:"link"},{default:n((()=>[s(l,{class:"form-input",modelValue:u(g).link,"onUpdate:modelValue":a[1]||(a[1]=e=>u(g).link=e),placeholder:"请输入链接"},null,8,["modelValue"])])),_:1}),s(t,{label:"排序：",prop:"order"},{default:n((()=>[s(i,{class:"form-input",modelValue:u(g).order,"onUpdate:modelValue":a[2]||(a[2]=e=>u(g).order=e)},null,8,["modelValue"])])),_:1}),s(t,{label:"是否开启：",prop:"status"},{default:n((()=>[s(c,{modelValue:u(g).status,"onUpdate:modelValue":a[3]||(a[3]=e=>u(g).status=e),class:"ml-2"},null,8,["modelValue"])])),_:1}),s(t,{label:"描述：",prop:"description"},{default:n((()=>[s(l,{class:"form-input",modelValue:u(g).description,"onUpdate:modelValue":a[4]||(a[4]=e=>u(g).description=e),placeholder:"输入描述",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),s(t,{style:{"padding-left":"100px"}},{default:n((()=>[s(V,{type:"primary",onClick:b},{default:n((()=>[p("保存")])),_:1}),s(V,{style:{"margin-left":"10px"},onClick:w},{default:n((()=>[p("取消")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}}}),x={class:"app-container"},D={class:"toolbar-wrapper"},U={class:"table-wrapper"},j={class:"pager-wrapper"},P=a({name:"Friendships"}),q=y(a({...P,setup(a){const l=i(!1),{paginationData:t,handleCurrentChange:y,handleSizeChange:k}=C(),z=i(!1),P=i(!1),q=i([]);c();const F={id:0,title:"",link:"",status:!0,order:0,description:""},O=i(Object.assign({},F)),$=()=>{var a,l;O.value.id>0?(a=O.value.id,l=O.value,e({url:`/friendship/${a}/update`,method:"post",data:l})).then((()=>{V.success("更新成功"),z.value=!1,E()})):function(a){return e({url:"/friendship/store",method:"post",data:a})}(O.value).then((()=>{V.success("添加成功"),z.value=!1,E()}))},A=a=>{var l;(l=a.id,e({url:`/friendship/${l}`,method:"delete"})).then((()=>{V.success("删除成功"),E()}))},B=a=>{var l,t;P.value=!0,(l=a.id,t={status:a.status},e({url:`/friendship/${l}/update-status`,method:"post",data:t})).then((()=>{V.success("更新成功")})).finally((()=>{P.value=!1}))},E=()=>{var a;l.value=!0,(a={page:t.currentPage,pageSize:t.pageSize},e({url:"/friendship/list",method:"get",params:a})).then((e=>{t.total=e.data.total,q.value=e.data.list})).catch((()=>{q.value=[]})).finally((()=>{l.value=!1}))};return m([()=>t.currentPage,()=>t.pageSize],E,{immediate:!0}),(e,a)=>{const i=r("el-button"),c=r("el-table-column"),m=r("el-switch"),V=r("el-popconfirm"),C=r("el-table"),E=r("el-pagination"),H=r("el-card"),I=f("loading");return d(),o("div",x,[g((d(),h(H,{shadow:"never"},{default:n((()=>[v("div",D,[v("div",null,[s(i,{type:"primary",icon:u(b),onClick:a[0]||(a[0]=e=>(O.value=Object.assign({},F),void(z.value=!0)))},{default:n((()=>[p("新增链接")])),_:1},8,["icon"])])]),v("div",U,[s(C,{data:q.value,"row-key":"id",border:"","default-expand-all":""},{default:n((()=>[s(c,{prop:"title",label:"标题",align:"center"}),s(c,{prop:"link",label:"链接",align:"center"}),s(c,{label:"是否开启",align:"center"},{default:n((({row:e})=>[s(m,{modelValue:e.status,"onUpdate:modelValue":a=>e.status=a,class:"ml-2",loading:P.value,onChange:a=>B(e)},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])])),_:1}),s(c,{prop:"created_at",label:"创建时间",align:"center"}),s(c,{fixed:"right",label:"操作",width:"240"},{default:n((({row:e})=>[s(i,{type:"primary",text:"",bg:"",size:"small",onClick:a=>(e=>{const{id:a,title:l,link:t,status:i,order:o,description:s}=e;O.value={id:a,title:l,link:t,status:i,order:o,description:s},z.value=!0})(e)},{default:n((()=>[p("编辑")])),_:2},1032,["onClick"]),s(V,{icon:u(w),"icon-color":"#626AEF",title:"真的要删除此条数据吗？",onConfirm:a=>A(e)},{reference:n((()=>[s(i,{type:"danger",text:"",bg:"",size:"small"},{default:n((()=>[p("删除")])),_:1})])),_:2},1032,["icon","onConfirm"])])),_:1})])),_:1},8,["data"]),z.value?(d(),h(S,{key:0,"show-dialog":z.value,"onUpdate:showDialog":a[1]||(a[1]=e=>z.value=e),friendship:O.value,"onUpdate:friendship":a[2]||(a[2]=e=>O.value=e),onHandleSubmit:$},null,8,["show-dialog","friendship"])):_("",!0)]),v("div",j,[s(E,{background:"",layout:u(t).layout,"page-sizes":u(t).pageSizes,total:u(t).total,"page-size":u(t).pageSize,currentPage:u(t).currentPage,onSizeChange:u(k),onCurrentChange:u(y)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1})),[[I,l.value]])])}}}),[["__scopeId","data-v-8de03ba0"]]);export{q as default};
